// Prisma schema

generator client {
  provider = "prisma-client-js"
}

generator zod {
  provider = "prisma-zod-generator"
  output   = "./src/zod"
  skipFiles = ["updateManyAndReturn*.schema.ts", "*ScalarRelationFilter.schema.ts"]
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model User {
  id           Int      @id @default(autoincrement())
  name         String?
  email        String   @unique
  passwordHash String
  role         String   @db.NVarChar(32) @default("USER")
  permissions  String?  @db.NVarChar(Max)
  locale       String   @default("pl")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("LocalUser")
  @@index([email])
}

model RolePermissions {
  id          Int      @id @default(autoincrement())
  module      String   @unique
  userAccess  Boolean  @default(false)
  advancedAccess Boolean @default(false)
  adminAccess Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Customer {
  id           Int        @id @default(autoincrement()) @map("CustID")
  name         String?    @map("Name") @db.VarChar(250)
  email        String?    @map("DefaultEmail") @db.VarChar(50)
  phone        String?    @map("DefaultPhone") @db.VarChar(20)
  address      String?    @map("Address1") @db.VarChar(150)
  city         String?    @map("City") @db.VarChar(50)
  postalCode   String?    @map("Zip") @db.VarChar(50)
  country      Int?       @map("CountryID")
  nip          String?    @map("TaxID") @db.VarChar(50)
  regon        String?    @map("VATID") @db.VarChar(50)
  notes        String?    @map("Remarks") @db.VarChar(250)
  createdAt    DateTime?  @default(now(), map: "DF__tblCustom__DateM__2D27B809") @map("DateMod") @db.DateTime
  invoices     Invoice[]

  @@map("tblCustomers")
}

model Author {
  id              Int      @id @default(autoincrement()) @map("ContactID")
  phoneNumber     String?  @db.VarChar(20) @map("PhoneNumber")
  firstName       String   @db.VarChar(30) @map("FirstName")
  middleName      String?  @db.VarChar(30) @map("MiddleName")
  lastName        String   @db.VarChar(50) @map("LastName")
  informal        Int      @default(0) @map("Informal")
  fax             String?  @db.VarChar(20) @map("Fax")
  email           String?  @db.VarChar(50) @map("Email")
  userMod         String   @default("suser_sname()") @db.VarChar(30) @map("UserMod")
  dateMod         DateTime @default(now()) @map("DateMod")
  contactPosition String?  @db.VarChar(50) @map("ContactPosition")
  accountant      Int?     @map("Accountant")

  @@map("tblContacts")
}

model Invoice {
  id                Int       @id @map("FVNr")
  date              DateTime  @map("FVDate")
  dateIssued        DateTime? @map("FVDateIssued")
  type              Int?      @map("FVType")
  clientId          Int?      @map("CustID")
  client            Customer? @relation(fields: [clientId], references: [id], onDelete: NoAction)
  origCurrency      String?   @db.NVarChar(Max) @map("OrigCurrency")
  fvCurrency        String?   @db.NVarChar(Max) @map("FVCurrency")
  graalPerc         Float?    @map("GraalPerc") @db.Money
  vatCode           String?   @db.NVarChar(Max) @map("VATCode")
  vatPerc           Float?    @map("VatPerc") @db.Money
  netAmt            Float?    @map("NetAmt") @db.Money
  netAmtCurr        Float?    @map("NetAmtCurr") @db.Money
  vatAmt            Float?    @map("VatAmt") @db.Money
  xrate             Float?    @map("XRate") @db.Money
  vatAmtCurr        Float?    @map("VatAmtCurr") @db.Money
  grossAmt          Float?    @map("GrossAmt") @db.Money
  invNr             Int?      @map("InvNr")
  invAmt            Float?    @map("InvAmt") @db.Money
  title             String?   @db.NVarChar(Max) @map("Title")
  isbnNr            String?   @db.NVarChar(Max) @map("ISBNNr")
  payType           String?   @db.NVarChar(Max) @map("PayType")
  invType           String?   @db.NVarChar(Max) @map("InvType")
  fvDescription     String?   @db.NVarChar(Max) @map("FVDescription")
  bilNr             Int?      @map("BilNr")
  origFVNr          Int?      @map("OrigFVNr")
  correctFVNr       Int?      @map("CorrectFVNr")
  creditId          Int?      @map("CreditID")
  applyId           Int?      @map("ApplyID")
  payDate           DateTime? @db.Date @map("PayDate")
  enterDate         DateTime? @map("EnterDate") @default(now())
  enterEmployee     String?   @db.NChar(10) @map("EnterEmployee")
  status            String?   @db.NChar(10) @map("Status")

  @@map("tblFraVAT_New")
}

model BalanceAdjustment {
  id          Int      @id @default(autoincrement())
  date        DateTime
  amount      Float
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
